package sample;

import java.io.DataOutputStream;
import java.io.IOException;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.charset.Charset;
import java.util.Random;

public class BufferExploit {

        public static String GenerateRandomString(int no){
            byte[] array = new byte[no];
            new Random().nextBytes(array); //fill the array with random code
            String generatedString = new String(array, Charset.forName("UTF-8"));
            return generatedString;
        }

        public static void SendStringLooped(String urladdress) throws IOException {

            urladdress = "http://" + urladdress;
            String tosend = GenerateRandomString(450);
            String urlParameters = "message=" + tosend;

            URL url = new URL(urladdress);

            HttpURLConnection connection = (HttpURLConnection) url.openConnection();

            connection.setDoOutput(true);
            connection.setDoInput(true);
            connection.setInstanceFollowRedirects(false);
            connection.setRequestMethod("POST");
            connection.setRequestProperty("Content-Type","application/x-www-form-urlencoded");
            connection.setRequestProperty("charset", "utf-8");
            connection.setRequestProperty("Content-Length","" + Integer.toString(urlParameters.getBytes().length));
            connection.setUseCaches(false);

            DataOutputStream bufferwriter = new DataOutputStream(connection.getOutputStream());
            bufferwriter.writeBytes(urlParameters);
            bufferwriter.flush();
            bufferwriter.close();
            connection.disconnect();
            System.out.print("String sent.");
        }
}
